import{d as he,t as m,a as be,b as x,s as h}from"../chunks/CSezO0wQ.js";import{p as _e,c as y,e as P,h as c,i as re,j as s,k as l,t as w,n as ye,g as e,s as u,$ as Ce,r as a,o as ae}from"../chunks/MmXCAxbs.js";import{i as b}from"../chunks/9DN416LK.js";import{e as ke,i as we,r as se,s as ie,a as Te}from"../chunks/BQ5M-c4W.js";import{c as $e,r as q,s as je,a as Ie,b as Se,d as Me,m as Pe,q as qe,e as ze,g as De,f as Ae,p as Fe,C as Ge}from"../chunks/Dpj7UOb_.js";const Ne=(T,g,_,C,$)=>{g?u(_,q(),!0):e(C).length&&($(),u(_,q(),!0))},Oe=(T,g)=>{u(g,q(),!0)},Be=(T,g,_)=>{u(g,Fe(e(g),e(_).filteredChineseText),!0)};var Ee=m(`<div class="mb-4"><div class="flex items-center justify-end gap-3"><label class="inline-flex items-center cursor-pointer"><span class="mr-2 text-sm font-medium text-gray-900 dark:text-gray-300">拆解圖</span> <input type="checkbox" class="sr-only peer"> <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div></label></div></div>`),He=m('<div class="mb-2"><div class="flex justify-center items-center"><div class="bg-gray-50 p-1 rounded-lg border" style="width: 112px; height: 102px;"><!></div></div></div>'),Je=m('<span data-testid="typing-char"> </span>'),Ke=m('<div class="mb-4 text-center"><div class="text-sm text-gray-600 bg-gray-50 py-2 px-4 rounded-lg inline-block"> </div></div>'),Le=m('<div class="mb-4"><input type="text" placeholder="開始打字..." class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-mono text-center" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" data-testid="typing-input"></div>'),Qe=m('<div class="flex justify-center mb-4"><div class="flex gap-6 text-sm text-gray-600" data-testid="typing-stats"><span>速度: <span class="font-medium text-gray-800"> </span> 字/分鐘</span></div></div>'),Re=m('<div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4" data-testid="completion-message"><div class="flex items-center"><img src="/icons/check.svg" alt="完成" class="h-5 w-5 mr-2"> <span class="font-medium">完成！</span></div> <div class="mt-3 grid grid-cols-3 gap-4 text-sm"><div class="text-center"><div class="text-gray-600 text-xs mb-1">速度</div> <div class="font-medium text-gray-800"> </div></div> <div class="text-center"><div class="text-gray-600 text-xs mb-1">用時</div> <div class="font-medium text-gray-800"> </div></div> <div class="text-center"><div class="text-gray-600 text-xs mb-1">字數</div> <div class="font-medium text-gray-800"> </div></div></div></div>'),Ue=m('<section class="w-full max-w-4xl mx-auto"><div class="bg-white rounded-lg shadow-md p-6 mb-6 max-w-xl mx-auto"><!> <!> <div class="mb-2"><div class="bg-gray-50 p-4 rounded-lg border text-lg leading-relaxed font-mono" data-testid="typing-text-display"></div></div> <!> <!> <!> <!> <div class="flex flex-row gap-3 justify-center"><button class="flex items-center justify-center px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" data-testid="reset-button"><img src="/icons/refresh.svg" alt="重置" class="h-4 w-4 mr-2" style="filter: invert(1);"> 重新開始</button> <button class="flex items-center justify-center px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors" data-testid="next-text-button"><img src="/icons/arrow-right.svg" alt="下一個" class="h-4 w-4 mr-2" style="filter: invert(1);"> </button></div></div></section>');function et(T,g){_e(g,!0);let _=!1,C=y(!0),$=y(P([])),f=y(P([])),j=y(P([])),O=y(0);async function ne(){if(!e(f).length)try{const t=await fetch("/texts/snippets.json");if(t.ok){const r=await t.json();u($,r.sources,!0),u(f,r.snippets,!0),B(),E(),u(n,q(),!0)}}catch(t){console.warn("Failed to load snippets:",t)}}function B(){u(j,Array.from({length:e(f).length},(t,r)=>r),!0),je(e(j))}function E(){if(!e(f).length)return;e(j).length===0&&B();const t=e(j).pop();t!==void 0&&u(O,t,!0)}let n=y(P($e()));const de=t=>t[0],le=t=>e($)[t[1]];let I=c(()=>e(f).length?e(f)[e(O)]:void 0),H=c(()=>e(I)?de(e(I)):""),S=c(()=>e(I)?le(e(I)):void 0),M=c(()=>Ie(e(H),e(n).userInput)),J=c(()=>Se(e(n).completedChars,e(n).startTime||0,e(n).endTime||void 0)),z=c(()=>e(M).currentChar),D=c(()=>e(z)?Me(qe,Pe.cangjie,e(z)).parts:"");re(()=>{console.log("Current user input:",e(n).userInput)}),re(()=>{e(f).length===0&&ne()});var A=Ue();be(t=>{Ce.title="打字練習 - 速成查字"});var K=s(A),L=s(K);{var oe=t=>{var r=Ee(),d=s(r),i=s(d),o=l(s(i),2);se(o),ae(2),a(i),a(d),a(r),ze(o,()=>e(C),v=>u(C,v)),x(t,r)};b(L,t=>{e(n).isCompleted||t(oe)})}var Q=l(L,2);{var ce=t=>{var r=He(),d=s(r),i=s(d),o=s(i);{var v=p=>{Ge(p,{get char(){return e(z)},get parts(){return e(D)},imageStyle:"width: 80px;",charStyle:"font-size: 14px; margin: 2px 3px;"})};b(o,p=>{e(D)&&e(D).length>0&&p(v)})}a(i),a(d),a(r),x(t,r)};b(Q,t=>{e(C)&&!e(n).isCompleted&&t(ce)})}var F=l(Q,2),R=s(F);ke(R,21,()=>e(H).split(""),we,(t,r,d)=>{var i=Je();const o=c(()=>De(d,e(r),e(M))),v=c(()=>e(o).isChinese),p=c(()=>e(o).isCompletedChinese),k=c(()=>e(o).isCurrentChinese);ie(i,"data-char-index",d);var N=s(i,!0);a(i),w(()=>{Te(i,1,`${e(v)?e(p)?"bg-green-50 text-green-700":e(k)?"bg-blue-100 text-blue-700 animate-pulse":"text-gray-400 opacity-60":"text-gray-400 opacity-60"}`),ie(i,"data-char-state",e(v)?e(p)?"completed":e(k)?"current":"pending":"neutral"),h(N,e(r))}),x(t,i)}),a(R),a(F);var U=l(F,2);{var ve=t=>{var r=Ke(),d=s(r),i=s(d);a(d),a(r),w(()=>h(i,`來源：${e(S).title??""}${(e(S).author?`（${e(S).author}）`:"")??""}`)),x(t,r)};b(U,t=>{var r;e(n).isCompleted&&((r=e(S))!=null&&r.title)&&t(ve)})}var V=l(U,2);{var pe=t=>{var r=Le(),d=s(r);se(d),d.__input=[Be,n,M],a(r),Ae(d,()=>e(n).userInput,i=>e(n).userInput=i),x(t,r)};b(V,t=>{e(n).isCompleted||t(pe)})}var W=l(V,2);{var ue=t=>{var r=Qe(),d=s(r),i=s(d),o=l(s(i)),v=s(o,!0);a(o),ae(),a(i),a(d),a(r),w(()=>h(v,e(J))),x(t,r)};b(W,t=>{e(n).isCompleted||t(ue)})}var X=l(W,2);{var ge=t=>{var r=Re(),d=l(s(r),2),i=s(d),o=l(s(i),2),v=s(o);a(o),a(i);var p=l(i,2),k=l(s(p),2),N=s(k);a(k),a(p);var ee=l(p,2),te=l(s(ee),2),xe=s(te);a(te),a(ee),a(d),a(r),w(me=>{h(v,`${e(J)??""} 字/分鐘`),h(N,`${me??""} 秒`),h(xe,`${e(M).filteredChineseText.length??""} 字`)},[()=>e(n).startTime&&e(n).endTime?Math.round((e(n).endTime-e(n).startTime)/1e3):0]),x(t,r)};b(X,t=>{e(n).isCompleted&&t(ge)})}var Y=l(X,2),Z=s(Y);Z.__click=[Oe,n];var G=l(Z,2);G.__click=[Ne,_,n,f,E];var fe=l(s(G));a(G),a(Y),a(K),a(A),w(()=>h(fe," 下一個文本")),x(T,A),ye()}he(["input","click"]);export{et as component};
