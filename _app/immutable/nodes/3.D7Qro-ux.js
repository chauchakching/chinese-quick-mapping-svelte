import{d as be,t as x,a as _e,b as m,s as h}from"../chunks/CSezO0wQ.js";import{p as ye,c as C,e as R,h as c,i as O,j as s,k as o,t as I,n as Ce,g as e,s as u,$ as we,r as a,o as se}from"../chunks/MmXCAxbs.js";import{i as b}from"../chunks/9DN416LK.js";import{e as ke,i as Te,r as ie,s as ne,a as Ie}from"../chunks/BQ5M-c4W.js";import{c as $e,r as q,s as Se,a as je,b as Me,d as Pe,m as Re,q as qe,e as De,g as ze,f as Be,p as Ee,C as Ae}from"../chunks/BM8ESafS.js";import{b as Fe}from"../chunks/BM25Jrjm.js";const Ge=($,g,_,w,S)=>{g?u(_,q(),!0):e(w).length&&(S(),u(_,q(),!0))},Ne=($,g)=>{u(g,q(),!0)},Oe=($,g,_)=>{u(g,Ee(e(g),e(_).filteredChineseText),!0)};var Ve=x(`<div class="mb-4"><div class="flex items-center justify-end gap-3"><label class="inline-flex items-center cursor-pointer"><span class="mr-2 text-sm font-medium text-gray-900 dark:text-gray-300">拆解圖</span> <input type="checkbox" class="sr-only peer"> <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div></label></div></div>`),He=x('<div class="mb-2"><div class="flex justify-center items-center"><div class="bg-gray-50 p-1 rounded-lg border" style="width: 112px; height: 102px;"><!></div></div></div>'),Je=x('<span data-testid="typing-char"> </span>'),Ke=x('<div class="mb-4 text-center"><div class="text-sm text-gray-600 bg-gray-50 py-2 px-4 rounded-lg inline-block"> </div></div>'),Le=x('<div class="mb-4"><input type="text" placeholder="開始打字..." class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-mono text-center" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" data-testid="typing-input"></div>'),Qe=x('<div class="flex justify-center mb-4"><div class="flex gap-6 text-sm text-gray-600" data-testid="typing-stats"><span>速度: <span class="font-medium text-gray-800"> </span> 字/分鐘</span></div></div>'),Ue=x('<div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4" data-testid="completion-message"><div class="flex items-center"><img src="/icons/check.svg" alt="完成" class="h-5 w-5 mr-2"> <span class="font-medium">完成！</span></div> <div class="mt-3 grid grid-cols-3 gap-4 text-sm"><div class="text-center"><div class="text-gray-600 text-xs mb-1">速度</div> <div class="font-medium text-gray-800"> </div></div> <div class="text-center"><div class="text-gray-600 text-xs mb-1">用時</div> <div class="font-medium text-gray-800"> </div></div> <div class="text-center"><div class="text-gray-600 text-xs mb-1">字數</div> <div class="font-medium text-gray-800"> </div></div></div></div>'),We=x('<section class="w-full max-w-4xl mx-auto"><div class="bg-white rounded-lg shadow-md p-6 mb-6 max-w-xl mx-auto"><!> <!> <div class="mb-2"><div class="bg-gray-50 p-4 rounded-lg border text-lg leading-relaxed font-mono overflow-y-auto h-16 md:h-22" style="line-height: 1.625;" data-testid="typing-text-display"></div></div> <!> <!> <!> <!> <div class="flex flex-row gap-3 justify-center"><button class="flex items-center justify-center px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" data-testid="reset-button"><img src="/icons/refresh.svg" alt="重置" class="h-4 w-4 mr-2" style="filter: invert(1);"> 重新開始</button> <button class="flex items-center justify-center px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors" data-testid="next-text-button"><img src="/icons/arrow-right.svg" alt="下一個" class="h-4 w-4 mr-2" style="filter: invert(1);"> </button></div></div></section>');function at($,g){ye(g,!0);let _=!1,w=C(!0),S=C(R([])),f=C(R([])),j=C(R([])),V=C(0);async function de(){if(!e(f).length)try{const t=await fetch("/texts/snippets.json");if(t.ok){const r=await t.json();u(S,r.sources,!0),u(f,r.snippets,!0),H(),J(),u(d,q(),!0)}}catch(t){console.warn("Failed to load snippets:",t)}}function H(){u(j,Array.from({length:e(f).length},(t,r)=>r),!0),Se(e(j))}function J(){if(!e(f).length)return;e(j).length===0&&H();const t=e(j).pop();t!==void 0&&u(V,t,!0)}let d=C(R($e()));const oe=t=>t[0],le=t=>e(S)[t[1]];let M=c(()=>e(f).length?e(f)[e(V)]:void 0),D=c(()=>e(M)?oe(e(M)):""),P=c(()=>e(M)?le(e(M)):void 0),y=c(()=>je(e(D),e(d).userInput)),K=c(()=>Me(e(d).completedChars,e(d).startTime||0,e(d).endTime||void 0)),z=c(()=>e(y).currentChar),B=c(()=>e(z)?Pe(qe,Re.cangjie,e(z)).parts:""),k;O(()=>{if(!k||!e(D)||e(y).currentChineseCharIndex<0)return;const t=k.querySelector(`[data-char-index="${e(y).currentChineseCharIndex}"]`);if(!t)return;const r=k.getBoundingClientRect(),i=t.getBoundingClientRect();(i.top<r.top||i.bottom>r.bottom)&&t.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}),O(()=>{console.log("Current user input:",e(d).userInput)}),O(()=>{e(f).length===0&&de()});var E=We();_e(t=>{we.title="打字練習 - 速成查字"});var L=s(E),Q=s(L);{var ce=t=>{var r=Ve(),i=s(r),n=s(i),l=o(s(n),2);ie(l),se(2),a(n),a(i),a(r),De(l,()=>e(w),p=>u(w,p)),m(t,r)};b(Q,t=>{e(d).isCompleted||t(ce)})}var U=o(Q,2);{var pe=t=>{var r=He(),i=s(r),n=s(i),l=s(n);{var p=v=>{Ae(v,{get char(){return e(z)},get parts(){return e(B)},imageStyle:"width: 80px;",charStyle:"font-size: 14px; margin: 2px 3px;"})};b(l,v=>{e(B)&&e(B).length>0&&v(p)})}a(n),a(i),a(r),m(t,r)};b(U,t=>{e(w)&&!e(d).isCompleted&&t(pe)})}var A=o(U,2),F=s(A);ke(F,21,()=>e(D).split(""),Te,(t,r,i)=>{var n=Je();const l=c(()=>ze(i,e(r),e(y))),p=c(()=>e(l).isChinese),v=c(()=>e(l).isCompletedChinese),T=c(()=>e(l).isCurrentChinese);ne(n,"data-char-index",i);var N=s(n,!0);a(n),I(()=>{Ie(n,1,`${e(p)?e(v)?"bg-green-50 text-green-700":e(T)?"bg-blue-100 text-blue-700 animate-pulse":"text-gray-400 opacity-60":"text-gray-400 opacity-60"}`),ne(n,"data-char-state",e(p)?e(v)?"completed":e(T)?"current":"pending":"neutral"),h(N,e(r))}),m(t,n)}),a(F),Fe(F,t=>k=t,()=>k),a(A);var W=o(A,2);{var ve=t=>{var r=Ke(),i=s(r),n=s(i);a(i),a(r),I(()=>h(n,`來源：${e(P).title??""}${(e(P).author?`（${e(P).author}）`:"")??""}`)),m(t,r)};b(W,t=>{var r;e(d).isCompleted&&((r=e(P))!=null&&r.title)&&t(ve)})}var X=o(W,2);{var ue=t=>{var r=Le(),i=s(r);ie(i),i.__input=[Oe,d,y],a(r),Be(i,()=>e(d).userInput,n=>e(d).userInput=n),m(t,r)};b(X,t=>{e(d).isCompleted||t(ue)})}var Y=o(X,2);{var ge=t=>{var r=Qe(),i=s(r),n=s(i),l=o(s(n)),p=s(l,!0);a(l),se(),a(n),a(i),a(r),I(()=>h(p,e(K))),m(t,r)};b(Y,t=>{e(d).isCompleted||t(ge)})}var Z=o(Y,2);{var fe=t=>{var r=Ue(),i=o(s(r),2),n=s(i),l=o(s(n),2),p=s(l);a(l),a(n);var v=o(n,2),T=o(s(v),2),N=s(T);a(T),a(v);var re=o(v,2),ae=o(s(re),2),xe=s(ae);a(ae),a(re),a(i),a(r),I(he=>{h(p,`${e(K)??""} 字/分鐘`),h(N,`${he??""} 秒`),h(xe,`${e(y).filteredChineseText.length??""} 字`)},[()=>e(d).startTime&&e(d).endTime?Math.round((e(d).endTime-e(d).startTime)/1e3):0]),m(t,r)};b(Z,t=>{e(d).isCompleted&&t(fe)})}var ee=o(Z,2),te=s(ee);te.__click=[Ne,d];var G=o(te,2);G.__click=[Ge,_,d,f,J];var me=o(s(G));a(G),a(ee),a(L),a(E),I(()=>h(me," 下一個文本")),m($,E),Ce()}be(["input","click"]);export{at as component};
