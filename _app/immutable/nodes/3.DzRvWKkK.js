import{d as be,t as x,h as _e,a as m,s as h}from"../chunks/Ymcw9Dae.js";import{p as ye,s as y,a as P,u as c,b as ae,c as s,d as l,t as T,e as Ce,g as e,f as u,$ as we,r as a,n as se}from"../chunks/DV3kNzOM.js";import{i as b}from"../chunks/C2b9LmBS.js";import{e as ke,i as Te,r as ie,s as ne,a as Ie}from"../chunks/BJJjnDYU.js";import{c as Se,a as $e,r as q,s as je,b as Me,d as Pe,e as qe,m as ze,q as De,f as We,g as Ae,h as Fe,p as Ge,C as Ne}from"../chunks/DLVO2nLz.js";const Oe=(I,g,_,z,C)=>{g?u(_,q(),!0):e(z).length&&(C(),u(_,q(),!0))},Be=(I,g)=>{u(g,q(),!0)},Ee=(I,g,_)=>{u(g,Ge(e(g),e(_).filteredChineseText),!0)};var He=x(`<div class="mb-4"><div class="flex items-center justify-end gap-3"><label class="inline-flex items-center cursor-pointer"><span class="mr-2 text-sm font-medium text-gray-900 dark:text-gray-300">拆解圖</span> <input type="checkbox" class="sr-only peer"> <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"></div></label></div></div>`),Je=x('<div class="mb-2"><div class="flex justify-center items-center"><div class="bg-gray-50 p-1 rounded-lg border" style="width: 112px; height: 102px;"><!></div></div></div>'),Ke=x('<span data-testid="typing-char"> </span>'),Le=x('<div class="mb-4 text-center"><div class="text-sm text-gray-600 bg-gray-50 py-2 px-4 rounded-lg inline-block"> </div></div>'),Qe=x('<div class="mb-4"><input type="text" placeholder="開始打字..." class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-mono text-center" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" data-testid="typing-input"></div>'),Re=x('<div class="flex justify-center mb-4"><div class="flex gap-6 text-sm text-gray-600" data-testid="typing-stats"><span>速度: <span class="font-medium text-gray-800"> </span> 字/分鐘</span></div></div>'),Ue=x('<div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4" data-testid="completion-message"><div class="flex items-center"><img src="/icons/check.svg" alt="完成" class="h-5 w-5 mr-2"> <span class="font-medium">完成！</span></div> <div class="mt-3 grid grid-cols-3 gap-4 text-sm"><div class="text-center"><div class="text-gray-600 text-xs mb-1">速度</div> <div class="font-medium text-gray-800"> </div></div> <div class="text-center"><div class="text-gray-600 text-xs mb-1">用時</div> <div class="font-medium text-gray-800"> </div></div> <div class="text-center"><div class="text-gray-600 text-xs mb-1">字數</div> <div class="font-medium text-gray-800"> </div></div></div></div>'),Ve=x('<section class="w-full max-w-4xl mx-auto"><div class="bg-white rounded-lg shadow-md p-6 mb-6 max-w-xl mx-auto"><!> <!> <div class="mb-2"><div class="bg-gray-50 p-4 rounded-lg border text-lg leading-relaxed font-mono" data-testid="typing-text-display"></div></div> <!> <!> <!> <!> <div class="flex flex-row gap-3 justify-center"><button class="flex items-center justify-center px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors" data-testid="reset-button"><img src="/icons/refresh.svg" alt="重置" class="h-4 w-4 mr-2" style="filter: invert(1);"> 重新開始</button> <button class="flex items-center justify-center px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors" data-testid="next-text-button"><img src="/icons/arrow-right.svg" alt="下一個" class="h-4 w-4 mr-2" style="filter: invert(1);"> </button></div></div></section>');function rt(I,g){ye(g,!0);const _=new Set(Se);let z=!1,C=y(!0),N=y(P([])),f=y(P([])),S=y(P([])),O=y(0);async function de(){if(!e(f).length)try{const t=await fetch("/texts/snippets.json");if(t.ok){const r=await t.json();u(N,r.sources,!0),u(f,r.snippets,!0),B(),E(),u(n,q(),!0)}}catch(t){console.warn("Failed to load snippets:",t)}}function B(){u(S,Array.from({length:e(f).length},(t,r)=>r),!0),je(e(S))}function E(){if(!e(f).length)return;e(S).length===0&&B();const t=e(S).pop();t!==void 0&&u(O,t,!0)}let n=y(P($e()));const le=t=>t[0],oe=t=>e(N)[t[1]];let $=c(()=>e(f).length?e(f)[e(O)]:void 0),H=c(()=>e($)?le(e($)):""),j=c(()=>e($)?oe(e($)):void 0),M=c(()=>Me(e(H),e(n).userInput)),J=c(()=>Pe(e(n).completedChars,e(n).startTime||0,e(n).endTime||void 0)),w=c(()=>e(M).currentChar);c(()=>e(w)&&_.has(e(w)));let D=c(()=>e(w)?qe(De,ze.cangjie,e(w)).parts:"");ae(()=>{console.log("Current user input:",e(n).userInput)}),ae(()=>{e(f).length===0&&de()});var W=Ve();_e(t=>{we.title="打字練習 - 速成查字"});var K=s(W),L=s(K);{var ce=t=>{var r=He(),d=s(r),i=s(d),o=l(s(i),2);ie(o),se(2),a(i),a(d),a(r),We(o,()=>e(C),v=>u(C,v)),m(t,r)};b(L,t=>{e(n).isCompleted||t(ce)})}var Q=l(L,2);{var ve=t=>{var r=Je(),d=s(r),i=s(d),o=s(i);{var v=p=>{Ne(p,{get char(){return e(w)},get parts(){return e(D)},imageStyle:"width: 80px;",charStyle:"font-size: 14px; margin: 2px 3px;"})};b(o,p=>{e(D)&&e(D).length>0&&p(v)})}a(i),a(d),a(r),m(t,r)};b(Q,t=>{e(C)&&!e(n).isCompleted&&t(ve)})}var A=l(Q,2),R=s(A);ke(R,21,()=>e(H).split(""),Te,(t,r,d)=>{var i=Ke();const o=c(()=>Ae(d,e(r),e(M))),v=c(()=>e(o).isChinese),p=c(()=>e(o).isCompletedChinese),k=c(()=>e(o).isCurrentChinese);ne(i,"data-char-index",d);var G=s(i,!0);a(i),T(()=>{Ie(i,1,`${e(v)?e(p)?"bg-green-50 text-green-700":e(k)?"bg-blue-100 text-blue-700 animate-pulse":"text-gray-400 opacity-60":"text-gray-400 opacity-60"}`),ne(i,"data-char-state",e(v)?e(p)?"completed":e(k)?"current":"pending":"neutral"),h(G,e(r))}),m(t,i)}),a(R),a(A);var U=l(A,2);{var pe=t=>{var r=Le(),d=s(r),i=s(d);a(d),a(r),T(()=>h(i,`來源：${e(j).title??""}${(e(j).author?`（${e(j).author}）`:"")??""}`)),m(t,r)};b(U,t=>{var r;e(n).isCompleted&&((r=e(j))!=null&&r.title)&&t(pe)})}var V=l(U,2);{var ue=t=>{var r=Qe(),d=s(r);ie(d),d.__input=[Ee,n,M],a(r),Fe(d,()=>e(n).userInput,i=>e(n).userInput=i),m(t,r)};b(V,t=>{e(n).isCompleted||t(ue)})}var X=l(V,2);{var ge=t=>{var r=Re(),d=s(r),i=s(d),o=l(s(i)),v=s(o,!0);a(o),se(),a(i),a(d),a(r),T(()=>h(v,e(J))),m(t,r)};b(X,t=>{e(n).isCompleted||t(ge)})}var Y=l(X,2);{var fe=t=>{var r=Ue(),d=l(s(r),2),i=s(d),o=l(s(i),2),v=s(o);a(o),a(i);var p=l(i,2),k=l(s(p),2),G=s(k);a(k),a(p);var te=l(p,2),re=l(s(te),2),xe=s(re);a(re),a(te),a(d),a(r),T(he=>{h(v,`${e(J)??""} 字/分鐘`),h(G,`${he??""} 秒`),h(xe,`${e(M).filteredChineseText.length??""} 字`)},[()=>e(n).startTime&&e(n).endTime?Math.round((e(n).endTime-e(n).startTime)/1e3):0]),m(t,r)};b(Y,t=>{e(n).isCompleted&&t(fe)})}var Z=l(Y,2),ee=s(Z);ee.__click=[Be,n];var F=l(ee,2);F.__click=[Oe,z,n,f,E];var me=l(s(F));a(F),a(Z),a(K),a(W),T(()=>h(me," 下一個文本")),m(I,W),Ce()}be(["input","click"]);export{rt as component};
